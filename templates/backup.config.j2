# GitHub Enterprise Server backup configuration file
# Generated by Ansible

# The hostname of the GitHub Enterprise Server appliance to back up
GHE_HOSTNAME="{{ ghe_hostname }}"

# Path to where backup data is stored
GHE_DATA_DIR="{{ ghe_data_dir }}"

# The number of backup snapshots to retain
GHE_NUM_SNAPSHOTS={{ ghe_num_snapshots }}

# If set to 'yes', backup and restore of Elasticsearch indices will be skipped
{% if ghe_skip_search_indices is defined %}
GHE_SKIP_SEARCH_INDICES={{ ghe_skip_search_indices | lower }}
{% else %}
#GHE_SKIP_SEARCH_INDICES=no
{% endif %}

# If set to 'yes', rsync will use compression during transfers
GHE_RSYNC_COMPRESSION_ENABLED={{ ghe_rsync_compression_enabled | lower }}

# If set to 'no', GHE_DATA_DIR will not be created automatically
GHE_CREATE_DATA_DIR={{ ghe_create_data_dir | lower }}

# If set to 'yes', ghe-backup jobs will run in parallel
GHE_PARALLEL_ENABLED={{ ghe_parallel_enabled | lower }}

# Sets the maximum number of jobs to run in parallel
{% if ghe_parallel_max_jobs is defined %}
GHE_PARALLEL_MAX_JOBS={{ ghe_parallel_max_jobs }}
{% endif %}

# When verbose output is enabled, write to log file
{% if ghe_verbose_logging %}
GHE_VERBOSE_LOG="{{ ghe_log_dir }}/backup-verbose.log"
{% endif %}

# If set to 'yes', Pages data will be included in backup and restore
GHE_BACKUP_PAGES={{ ghe_backup_pages | lower }}

# SSH options for cluster environments
{% if ghe_extra_ssh_opts is defined %}
GHE_EXTRA_SSH_OPTS="{{ ghe_extra_ssh_opts }}"
{% else %}
#GHE_EXTRA_SSH_OPTS=""
{% endif %}

# Rsync options
{% if ghe_extra_rsync_opts is defined %}
GHE_EXTRA_RSYNC_OPTS="{{ ghe_extra_rsync_opts }}"
{% endif %}

# MSSQL backup cadence (if applicable)
{% if ghe_mssql_backup_cadence is defined %}
GHE_MSSQL_BACKUP_CADENCE={{ ghe_mssql_backup_cadence }}
{% endif %}

# External database backup scripts (if applicable)
{% if external_database_backup_script is defined %}
EXTERNAL_DATABASE_BACKUP_SCRIPT="{{ external_database_backup_script }}"
{% endif %}

{% if external_database_restore_script is defined %}
EXTERNAL_DATABASE_RESTORE_SCRIPT="{{ external_database_restore_script }}"
{% endif %}
