---
# templates/common/service_account.yml.j2
# Generic Service Account (non-cloud-specific)
apiVersion: v1
kind: ServiceAccount
metadata:
  name: {{ service_account.name | default(app_name ~ '-sa') }}
  namespace: {{ namespace }}
  labels:
    app.kubernetes.io/name: {{ app_name }}
    app.kubernetes.io/component: service-account
    app.kubernetes.io/managed-by: ansible
{% if service_account.labels is defined %}
{% for key, value in service_account.labels.items() %}
    {{ key }}: "{{ value }}"
{% endfor %}
{% endif %}
{% if service_account.annotations is defined and service_account.annotations | length > 0 %}
  annotations:
{% for key, value in service_account.annotations.items() %}
    {{ key }}: "{{ value }}"
{% endfor %}
{% endif %}
{% if service_account.image_pull_secrets is defined %}
imagePullSecrets:
{% for secret in service_account.image_pull_secrets %}
  - name: {{ secret }}
{% endfor %}
{% endif %}
