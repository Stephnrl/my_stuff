---
# =============================================================================
# Monitoring Role - Handlers
# =============================================================================

- name: Reload systemd
  ansible.builtin.systemd:
    daemon_reload: yes

- name: Restart CloudWatch agent
  ansible.builtin.command:
    cmd: /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl -a fetch-config -m ec2 -s -c file:/opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.json
  ignore_errors: yes
  # May fail during AMI build since instance metadata isn't available
